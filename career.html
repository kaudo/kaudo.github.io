<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<!--<meta name="viewport" content="width=device-width,initial-scale=1.0"/>-->
<meta name="viewport" content="width=480,user-scalable=no"/><!---->
<link rel="stylesheet" href="career/default.css"/>
<style type="text/css">

</style>
<script type="text/javascript" src="lib/jquery-3.5.0.min.js"></script>
<script type="text/javascript" src="career/languages.js"></script>
<script type="text/javascript" src="career/drag.js"></script>
<script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=36c64c6e2feec27297abe3bdc2cf8f5e"></script>
<script type="text/javascript">
//<![CDATA[
var pressedBtnBack=-1;
var clickBtnBack=function(){
    if($('#loading:visible').length){ $('#loading').hide();return false; }
    if($('#toast:visible').length){ $('#toast').hide();return false; }
    if($('#map:visible').length){ $('#map').hide();return false; }
    if($('#menu:visible').length){ $('#menu').hide();return false; }
    if(new Date().getTime()-pressedBtnBack<500){
        toast('quit');
        call.quit();
        return false;
    }
    pressedBtnBack=new Date().getTime();
};


var dataFavorite=[];
var dataHistory=[];

var gData;
var gList;
var gResultType='json';
var gCountPerPage=12;
var gCurrentPage=0;
var gTotalCount;
var gKeyword='';

var gCity='여수시';
var gKeyword='어린';
var gChildOver;
var gChildLess;
var gRoomOver;
var gRoomLess;


var kakaoMap;
var kakaoMarker;
var kakaoCustomOverlay;

var toast=function(strMessage){
    //if(typeof(call)=='undefined') alert(strMessage);
    //else call.toast(strMessage);
    $('#loading').hide();
    $('#toast div').html(strMessage);
    $('#toast').show();
    setTimeout(function(){
        $('#toast').fadeOut(500,'swing'/*swing,linear*/, function(){console.log('toast complete');});
    },500);
};

$(window).resize(resizeWindow=function(){
    $('#content').css({height:$('html').height()-$('#header').height()-$('#footer').height(),visibility:'visible'});
    //$('#menu').css({height:$('html').height()});
});

$(document).ready(function(){

    $('.checkFavorite').unbind('click').click(checkFavorite=function(){
        $('.btnFavorite').removeClass('on');
        if(typeof(dataFavorite)!='object') return false;
        $.each(dataFavorite,function(idx,obj){
            $('.roadAddr:contains("'+obj.roadAddr+'")').parent().find('.btnFavorite').addClass('on');//.css('background-position','-35px 0px');
        });
        return false;
    });

    $('.setBtnCopy').unbind('click').click(setBtnCopy=function(){
        $('.btnCopy').unbind('click').click(function(e){
            var strCopy=$(this).parent().text();
            $('input[name="copy"]').val(strCopy);
            $('input[name="copy"]').select();
            document.execCommand('copy');
            $('input[name="copy"]').blur();
            toast('클립보드에 복사되었습니다.');
            return false;
        });
        return false;
    });

    $('.setBtnFavorite').unbind('click').click(setBtnFavorite=function(){
        $('.btnFavorite').unbind('click').click(function(e){
            if($(this).hasClass('on')){
                var objectDelete=$(this).parent();
                $.each(dataFavorite,function(idx,obj){
                    if(objectDelete.find('.roadAddr').text()==obj.roadAddr){
                        dataFavorite.splice(idx,1);
                        return false;
                    }
                });
            }else{
                dataFavorite.push($(this).parent().data('data'));
            }
            checkFavorite();
            if(typeof(call)!='undefined') call.putSharedPreferences('dataFavorite',JSON.stringify(dataFavorite));
            return false;
        });
        return false;
    });


    $('.setBtnMap').unbind('click').click(setBtnMap=function(){
        $('.btnMap').unbind('click').click(function(e){
            var dataRoadAddr=$(this).parent().data('data').roadAddr;
            $('#loading').fadeIn(100).fadeTo("fast",0.8);
            /*
            $.ajax({
                url:'https://www.juso.go.kr/addrlink/addrCoordApiJsonp.do',
                type:'post',
                dataType:'jsonp',
                data:data,
                error:function(xhr,status,error){ $('#loading').hide();return; },
                success:function(data){
                console.log(data.results.juso[0].entX,data.results.juso[0].entY);
                }
            }); // $.ajax({
            */
            $.ajax({
                url: 'https://dapi.kakao.com/v2/local/search/address.json?query='+dataRoadAddr,
                headers:{'Authorization':'KakaoAK 47a843a030bb5754622f3003c4bcb38c'},
                type:'GET'
            }).done(function(data){
                $('#map').show();
                kakaoMap=new kakao.maps.Map(document.getElementById('kakaoMap'),{center:new kakao.maps.LatLng(data.documents[0].y,data.documents[0].x),level:3,});
                kakaoMarker=new kakao.maps.Marker({map:kakaoMap,position:kakaoMap.getCenter(),});
                //var marker=new kakao.maps.Marker({position:kakaoMap.getCenter()}).setMap(map);
                kakaoCustomOverlay=new kakao.maps.CustomOverlay({
                    //position:new kakao.maps.LatLng(parseFloat(data.documents[0].y)+0.0005,data.documents[0].x),
                    position:kakaoMap.getCenter(),
                    content:'<div style="background-color:#fff;border:1px #333 solid;border-radius: 5px;padding: 2px 6px;margin-top:-65px;"><span class="left"></span><span class="center">'+dataRoadAddr+'</span><span class="right"></span></div>'
                }).setMap(kakaoMap);

                $('#loading').hide();

            });
            return false;
        }); // $('.btnMap').unbind('click').click(function(e){
        return false;
    });


    $('input[name="keyword"]').bind('keyup',function(e){if(e.keyCode==13)searchZipcodeRoad();});

	$('#content').scroll(function(e){
		if($('#loading:visible').length) return false;
		//if($('#content').scrollTop()+$('#content').height()>=$('#content').prop('scrollHeight')-10) searchZipcodeRoad();
    });

/*
    $('.btnMenu').unbind('click').click(function(){
        $('.areaFavorite').html('');
        for(var i=0;i<dataFavorite.length;i++){
            $('.areaFavorite').append('<div class="item">'+
                '<button class="btnFavorite on" style="float:right;">즐겨찾기</button>'+
                '<button class="btnMap" style="float:right;">지도</button>'+
                '<font class="zipNo"><button class="btnCopy"></button>'+dataFavorite[i].zipNo+'</font><br/>'+
                '<font class="roadAddr"><button class="btnCopy"></button>'+dataFavorite[i].roadAddr+'</font><br/>'+
                '<font class="jibunAddr"><button class="btnCopy"></button>'+dataFavorite[i].jibunAddr+'</font><br/>'+
                '<font class="engAddr"><button class="btnCopy"></button>'+dataFavorite[i].engAddr+'</font></div>');
            $('.areaFavorite .item:last').data('data',dataFavorite[i]);
        }
        //$('.txtTotalCount').html(gData.totalCount);
        //$('.txtCurrentCount').html($('.item').length);
        setBtnCopy();
        setBtnFavorite();
        setBtnMap();
        $('#menu').show();
		$('#menu .inner').css('left','100%').animate({left:'0'},400,function(){});
		return false;
    });

    $('.btnCloseMenu').unbind('click').click(function(){
        $('#menu .inner').animate({left:'100%'},400,function(){
			$('#menu').hide();
			$('html,body').css({'height':'','overflow':''});
			$('#header .btnOpenMenu').focus();
		});
		return false;
    });

    $('.btnCloseMap').unbind('click').click(function(){
        $('#kakaoMap').html('');
        $('#map').hide();
        return false;
    });

    $('.btnLogo, #info').unbind('click').click(function(){
        $('#info').toggle();
        return false;
    });
*/

    $('#info button').unbind('click');
    resizeWindow();
    if(typeof(call)!='undefined'){
        if(call.getSharedPreferences('dataFavorite') && call.getSharedPreferences('dataFavorite')!='undefined')
            dataFavorite=JSON.parse(call.getSharedPreferences('dataFavorite'));
        if(call.getSharedPreferences('dataHistory') && call.getSharedPreferences('dataHistory')!='undefined')
            $('input[name="keyword"]').val(call.getSharedPreferences('dataHistory'));
            //$('input[name="keyword"]').val(JSON.parse(call.getSharedPreferences('dataFavorite'))[0].keyword);
    }
	//if(!$('input[name="keyword"]').val()) $('input[name="keyword"]').val('강동구 천호대로 지하 1097');
    //$('.btnSearch:first').click();
    $('#loading').hide();

	$('.btnCloseMap').unbind('click').click(function(){
		$('.areaMap').hide();
		return false;
	});


	for(var i=0;i<100;i++){
		$('select[name="selectChildOver"]').append('<option value="'+i+'">'+i+'명</option>');
	}
	for(var i=0;i<100;i++){
		$('select[name="selectChildLess"]').append('<option value="'+i+'">'+i+'명</option>');
	}
	for(var i=0;i<100;i++){
		$('select[name="selectRoomOver"]').append('<option value="'+i+'">'+i+'명</option>');
	}
	for(var i=0;i<100;i++){
		$('select[name="selectRoomLess"]').append('<option value="'+i+'">'+i+'명</option>');
	}

	$('.btnCity').unbind('click').click(clickBtnSearch=function(){
		$('.areaList').html('');
		$.each($.data,function(idx,item){
			if(gCity && item.city!=gCity) return true;
			if(gKeyword && item.name.indexOf(gKeyword)<0 && item.address.indexOf(gKeyword)<0
				&& item.phone.indexOf(gKeyword)<0 && item.fax.indexOf(gKeyword)<0) return true;
			if(gChildOver && parseInt(item.child)<gChildOver) return true;
			if(gChildLess && parseInt(item.child)>gChildLess) return true;
			if(gRoomOver && parseInt(item.room)<gRoomOver) return true;
			if(gRoomLess && parseInt(item.room)>gRoomLess) return true;
			$('.areaList').append(''+
			item.name+', '+
			item.city+', '+
			item.phone+', '+
			item.fax+', '+
			item.address+', '+
			'<br/>');

		});
	});

    clickBtnSearch();

});
</script>
</head>
<body>
<header id="header" style="background-color:silver">
	<button class="btnLogo" style="position:absolute;left:3px;top:2px;">아이콘</button>
	<h1 style="background-color:#0055aa;color:white;">전라남도 어린이집</h1>

	<button class="btnMenu" style="position:absolute;right:3px;top:2px;">메뉴</button>
	<div id="menu" class="allmenu_new main" style="z-index:500;display:none;background-color:rgba(0,0,0,0.6);position:fixed;left:0;top:0;width:100%;height:832px;">
		<div class="inner" style="position:relative;left:100%;height:100%;box-sizing:border-box;margin-left:100px;">
			<nav id="nav" style="position:absolute;top:0;width:100%;height:100%;background-color:#eee">
				<button class="btnCloseMenu" style="position:absolute;left:3px;top:2px;width:35px;height:35px;letter-spacing:-10px;border:0;color:transparent;background:url('icon_close.png') no-repeat 0px 0px / cover">닫기</button>
				<h1 style="color:#333;">즐겨찾기</h1>
				<div class="areaFavorite" style="height:100%;xxxoverflow-y:scrollxxxx"></div>
			</nav>
			<div class="btn_close_menu main"><a href="#none" style="top: 300px;">닫기</a></div>
		</div>
	</div>

<style>
select{font:normal bold 16px/18px -webkit-control;font-family:'나눔 고딕';}
.txtSearch{display:inline-block;width:50px;line-height:25px;margin:0 5px;}
</style>

	<input type="text" name="copy" style="position:absolute;width:1px;height:1px;border:0;"/>
	<div class="areaSearch">
		<div class="txtSearch" style="text-align:right;">정원</div> <select name="selectChildOver"></select><div class="txtSearch" style="text-align:left;">이상</div><select name="selectChildLess"></select><div class="txtSearch" style="text-align:left;">이하</div>
		<input name="keyword" maxlength="50" style="position:absolute;right:26px;width:140px;height:23px;border:1px gray solid;padding:0 3px;background-color:white;font:normal bold 16px/18px message-box;"/><button class="btnSearch" style="position:absolute;right:2px;">검색</button>
		<br/>
		<div class="txtSearch" style="text-align:right;">교실수</div> <select name="selectRoomOver"></select><div class="txtSearch" style="text-align:left;">이상</div><select name="selectRoomLess"></select><div class="txtSearch" style="text-align:left;">이하</div><br/>
	</div>

</header>
<div id="container"><div id="wrapper"><div id="content">


	<div class="areaMap">
		<button class="btnCloseCircle btnCloseMap" style="z-index:710;position:absolute;margin:100px;width:35px;height:35px;">닫기</button>
		<button class="btnCity drag" style="position:absolute;left:197px;top:311px;">강진군</button>
		<button class="btnCity drag" style="position:absolute;left:377px;top:138px;">구례군</button>
		<button class="btnCity drag" style="position:absolute;left:344px;top:328px;">고군</button>
		<button class="btnCity drag" style="position:absolute;left:314px;top:145px;">곡성군</button>
		<button class="btnCity drag" style="position:absolute;left:414px;top:200px;">광양시</button>
		<button class="btnCity drag" style="position:absolute;left:195px;top:210px;">나주시</button>
		<button class="btnCity drag" style="position:absolute;left:260px;top:126px;">담양군</button>
		<button class="btnCity drag" style="position:absolute;left:123px;top:226px;">무안군</button>
		<button class="btnCity drag" style="position:absolute;left:126px;top:269px;">목포시</button>
		<button class="btnCity drag" style="position:absolute;left:295px;top:268px;">보성군</button>
		<button class="btnCity drag" style="position:absolute;left:343px;top:213px;">순천시</button>
		<button class="btnCity drag" style="position:absolute;left:68px;top:269px;">신안군</button>
		<button class="btnCity drag" style="position:absolute;left:420px;top:269px;">여수시</button>
		<button class="btnCity drag" style="position:absolute;left:183px;top:258px;">영암군</button>
		<button class="btnCity drag" style="position:absolute;left:145px;top:176px;">영광군</button>
		<button class="btnCity drag" style="position:absolute;left:210px;top:415px;">완도</button>
		<button class="btnCity drag" style="position:absolute;left:255px;top:311px;">장흥군</button>
		<button class="btnCity drag" style="position:absolute;left:203px;top:118px;">정선군</button>
		<button class="btnCity drag" style="position:absolute;left:89px;top:380px;">진도</button>
		<button class="btnCity drag" style="position:absolute;left:134px;top:136px;">함평군</button>
		<button class="btnCity drag" style="position:absolute;left:153px;top:339px;">해남군</button>
		<button class="btnCity drag" style="position:absolute;left:260px;top:206px;">화순군</button>
		<img src="map.jpg"/>
	</div>

	<div class="areaList"></div>

</div></div></div>
<div id="footer">

	<div data-lang="text_info" style="display:table-cell;padding:0 5px;vertical-align:middle;font:normal normal 11px/11px message-box;line-height:10px;letter-spacing:-0.4px"></div>
	<div style="display:table-cell;padding:0 5px;vertical-align:middle;font:normal normal 11px/11px message-box;line-height:10px;letter-spacing:-0.4px;width:80px;text-align:right;">총 <font class="txtTotalCount">0</font>건, <font class="txtCurrentCount">0</font>건</div>

</div>

<div id="loading"><div><img src="loading.gif" alt="loading"/></div></div>
<div id="toast"><div></div></div>

<div id="map">
	<button class="btnCloseMap" style="z-index:710;position:absolute;left:5px;top:5px;width:35px;height:35px;letter-spacing:-10px;border:0;color:transparent;background:url('icon_close_white.png') no-repeat 0px 0px / cover;background-color:#555;">닫기</button>
	<div id="kakaoMap"></div>
</div>
<div id="info">
	<div style="color: #ccc;width:180px;word-break: break-all;margin:0 auto;position: absolute;left: 50%;top: 100px;margin: 0 0 0 -90px;">

		<button class="btnLogo" style="margin:0;width:25px;height:25px;vertical-align:middle;background:url('icon_home_white.png') no-repeat 0px 0px / cover;">아이콘</button> 집코드<br/>
		<button class="btnMenu" style="margin:0;width:25px;height:25px;vertical-align:middle;">아이콘</button> 즐겨찾기 보기<br/>
		<button class="btnSearch" style="margin:0;width:25px;height:25px;vertical-align:middle;background:url('icon_search_white.png') no-repeat 0px 0px / cover;"></button> 검색<br/>
		<button class="btnCopy" style="margin:0;width:25px;height:25px;vertical-align:middle;background:url('icon_copy_white.png') no-repeat 0px 0px / cover;"></button> 클립보드에 복사<br/>
		<button class="btnMap" style="margin:0;width:25px;height:25px;vertical-align:middle;background:url('icon_map_white.png') no-repeat 0px 0px / cover;">지도</button> 지도보기<br/>
		<button class="btnFavorite on" style="margin:0;width:25px;height:25px;vertical-align:middle;background:url('icon_star_white_toggle.png') no-repeat 0px 0px / cover;">즐겨찾기</button> 즐겨찾기 등록/해제<br/>

	</div>
</div>

</body>
</html>
